### 장애 내용

시간: 10시 40분

배송매니저 > 기본 정보가 무한 로딩이 걸리면서 해당 이미지처럼 오류가 뜨며 접속이 안되는 현상 발생 (2023-12-13에도 같은 이슈 발생)

20231213에는
12월 11일 21시 30분 1대 다운 ->  12월 13일 21시 06분 1대 다운 -> 0대 alive (장애 발생)
-> 21:42 수동으로 2대 살림

![[스크린샷 2023-12-21 오전 11.53.21.png]]
### 표면적 원인

rps-admin-api를 구성하는 인스턴스 2대가 모두 다운됨. (unhealthy)
한대는 이전에 다운됐고 나머지 한대 마저 다운되며 장애 발생.
한대 다운됐을때 auto scaling이 설정되어있지 않았음. (auto-scaling 요청하였지만 스케일 아웃을 통한 unhealthy 대응은 지양한다는 거부의 답변을 들음)

원인 미상의 ALB 그룹 제외로 인한 rps-admin-api 서비스 불가를 방지하고자 다시한번 활성화된 인스턴스가 2개 미만인 상태가 12시간 ~ 24시간 유지되면 스케일링 아웃 실행하도록 요청. 이슈 분석과 대응이 오래걸릴것 같아 해당 조건을 플랫폼엔지니어팀에서 활성화 시켜줌.

서버가 자꾸 다운되는 원인은 계속 파악중...

문제가 의심되는 cache 사용 부분 제거
- 제거 cache
`DAILY_LOGISTICS_CAPA (물량캐파)`/ `DAILY_ROUND_CAPA`, `DAILY_TC_CAPA` / `DELIVERY_MANAGER_INFO (배송매니저 정보)`

10월 22일부터 인스턴스 하나씩 죽고 살아나고 했다함.
12월 5일 출근지원 배포 (12월 5일 이전 버전으로 롤백해서 경과 지켜볼 예정)
12월 7일 엑셀 관련 배포

근무근태 기본 기능이 전부 안됨
close wait되면서 hang걸려서 

리엑티브 관련 스레드에서 블록
이벤트컨피그에서 block하는 큐를 non-block 큐로 바꾸면? (근데 진작에 문제됐거나 다른 환경에서도 문제 발생했어야함..)


소규모 조직개편
1팀 2팀 합치려고 한다. 스쿼드는 유지. 딜리버리 개발팀, 기획팀으로만 변경
메이 스쿼드는 유지. 1월 1일에 발령
스쿼드도 쪼개질 가능성 추측... 

- 인턴땐 멘토였던 팀장님 퇴사. (같이 진행중이던 e2e 테스트건 혼자 마무리하게됨)
- 새로들어온 그룹장겸 팀장님 개인사정으로 인한 퇴사
- 팀내 기획자분 퇴사
- 1, 2팀 조직개편

